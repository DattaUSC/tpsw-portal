<% depts = "BT CE CH CS EC EE IT ME MM".split(" ") %>
<div class="departments-taglist">
<% depts.each_with_index do |field,index| %>
  <% if index%7 == 0 and index!=0%>
  <br/>
  <% end %>
  <% if @object.departments.include?(field) %>
    <input checked="checked" class="columns_checkbox" type="checkbox" id="<%= field %>" />
    <label for="<%= field %>"><%= field %></label>&nbsp &nbsp
  <% else %>
    <input class="columns_checkbox" type="checkbox" id="<%= field %>" />
    <label for="<%= field %>"><%= field %></label>&nbsp &nbsp
  <% end %>
<% end %>
</div>
<textarea class="form-control" required="required" name="company[departments]" id="company_departments" style="display:none;">
</textarea>
<script>
$(document).ready(function(){

    $("#company_departments").text('');
    $(".departments-taglist :checked").each(function(){
         $("#company_departments").append( $(this).attr('id') + " ");
    });

    $(".departments-taglist input").click(function(){
         $("#company_departments").text('');
         $(".departments-taglist :checked").each(function(){
              $("#company_departments").append( $(this).attr('id') + " ");
         });
    });


});
</script>
